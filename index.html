<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KTKWM5G5XK"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-KTKWM5G5XK');
    </script>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="CYPHERPUNK: 2001 - MMORPG ONLINE">
    <meta property="og:description" content="the system didn't crash. it just stopped caring.">
    <meta property="og:image" content="https://cypher2k1.net/assets/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="https://cypher2k1.net">
    <meta property="og:site_name" content="CYPHERPUNK 2001">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CYPHERPUNK: 2001 - MMORPG ONLINE">
    <meta name="twitter:description" content="the system didn't crash. it just stopped caring.">
    <meta name="twitter:image" content="https://cypher2k1.net/assets/og-image.jpg">

    <link rel="icon" type="image/png" href="assets/favicon.png">
    <title>CYPHERPUNK 2001 // ARCHIVE NODE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <!-- SVG Pixelation Filters -->
    <svg style="position: absolute; width: 0; height: 0;">
        <defs>
            <filter id="pixelate-heavy" x="0" y="0" width="100%" height="100%">
                <feFlood x="2" y="2" width="4" height="4" />
                <feComposite width="8" height="8" />
                <feTile result="tile" />
                <feComposite in="SourceGraphic" in2="tile" operator="in" />
                <feMorphology operator="dilate" radius="4" />
            </filter>
            <filter id="pixelate-medium" x="0" y="0" width="100%" height="100%">
                <feFlood x="1" y="1" width="2" height="2" />
                <feComposite width="4" height="4" />
                <feTile result="tile" />
                <feComposite in="SourceGraphic" in2="tile" operator="in" />
                <feMorphology operator="dilate" radius="2" />
            </filter>
            <filter id="pixelate-light" x="0" y="0" width="100%" height="100%">
                <feFlood x="0.5" y="0.5" width="1" height="1" />
                <feComposite width="2" height="2" />
                <feTile result="tile" />
                <feComposite in="SourceGraphic" in2="tile" operator="in" />
                <feMorphology operator="dilate" radius="1" />
            </filter>
        </defs>
    </svg>

    <div class="lightbox" id="lightbox">
        <button class="lightbox-arrow lightbox-prev" id="lightbox-prev">&#10094;</button>
        <div class="lightbox-content" id="lightbox-content">
            <div class="lightbox-controls">
                <button class="lightbox-btn" id="lightbox-maximize">[ MAXIMIZE ]</button>
                <button class="lightbox-btn" id="lightbox-close">[ CLOSE ]</button>
            </div>
            <img src="" alt="" id="lightbox-img">
            <div class="lightbox-caption" id="lightbox-caption"></div>
        </div>
        <button class="lightbox-arrow lightbox-next" id="lightbox-next">&#10095;</button>
        <div class="lightbox-hint">CLICK IMAGE OR OUTSIDE TO CLOSE // ARROWS TO NAVIGATE</div>
    </div>

    <div class="crt-overlay"></div>
    <div class="scan-line"></div>
    <div class="corruption-line"></div>
    <div class="corruption-line"></div>
    <div class="corruption-line"></div>

    <div class="top-social">
        <a href="https://discord.gg/DSNShkBTdb" class="social-link" title="Discord"><img src="assets/discord.webp" alt="Discord" loading="lazy"></a>
        <a href="#" class="social-link" title="Twitch"><img src="assets/twitch.webp" alt="Twitch" loading="lazy"></a>
        <a href="#" class="social-link" title="YouTube"><img src="assets/youtube.webp" alt="YouTube" loading="lazy"></a>
        <a href="https://github.com/cypherpunk2001" class="social-link" title="GitHub"><img src="assets/github.webp" alt="GitHub" loading="lazy"></a>
        <a href="#" class="steam-wishlist" title="Wishlist on Steam"><img src="assets/steam_wishlist.webp" alt="Wishlist on Steam" loading="lazy"></a>
    </div>

    <div class="music-player" id="music-player" style="display: none;">
        <div class="player-header">
            <span class="player-title">.:[AUDIO_PLAYER]:.</span>
            <div class="player-controls-header">
                <button class="player-toggle" id="player-toggle">[ _ ]</button>
                <button class="player-close" id="player-close">[ X ]</button>
            </div>
        </div>
        <div class="player-body" id="player-body">
            <div class="track-info">
                <div class="track-name" id="track-name">NO TRACK LOADED</div>
                <div class="track-time">
                    <span id="current-time">00:00</span> / <span id="total-time">00:00</span>
                </div>
            </div>
            <div class="player-controls">
                <button class="control-btn" id="prev-btn">&#9664;&#9664;</button>
                <button class="control-btn play-btn" id="play-btn">&#9654;</button>
                <button class="control-btn" id="next-btn">&#9654;&#9654;</button>
            </div>
            <div class="progress-bar" id="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="volume-control">
                <span class="volume-label">VOL:</span>
                <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="70">
                <span class="volume-value" id="volume-value">70%</span>
            </div>
            <div class="playlist">
                <div class="playlist-header">TRACKS:</div>
                <div class="playlist-tracks" id="playlist-tracks"></div>
            </div>
        </div>
        <audio id="audio-player"></audio>
    </div>

    <div class="terminal-frame">
        <header class="header">
            <div class="ascii-logo">
<pre>
     ██████╗██╗   ██╗██████╗ ██╗  ██╗███████╗██████╗ ██████╗ ██╗   ██╗███╗   ██╗██╗  ██╗
    ██╔════╝╚██╗ ██╔╝██╔══██╗██║  ██║██╔════╝██╔══██╗██╔══██╗██║   ██║████╗  ██║██║ ██╔╝
    ██║      ╚████╔╝ ██████╔╝███████║█████╗  ██████╔╝██████╔╝██║   ██║██╔██╗ ██║█████╔╝
    ██║       ╚██╔╝  ██╔═══╝ ██╔══██║██╔══╝  ██╔══██╗██╔═══╝ ██║   ██║██║╚██╗██║██╔═██╗
    ╚██████╗   ██║   ██║     ██║  ██║███████╗██║  ██║██║     ╚██████╔╝██║ ╚████║██║  ██╗
     ╚═════╝   ╚═╝   ╚═╝     ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝      ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝
</pre>
                <div class="ascii-2001">
<pre>
               ██████╗  ██████╗  ██████╗  ██╗
              ╚════██╗██╔═══██╗██╔═══██╗███║
               █████╔╝██║   ██║██║   ██║╚██║
              ██╔═══╝ ██║   ██║██║   ██║ ██║
              ███████╗╚██████╔╝╚██████╔╝ ██║
              ╚══════╝ ╚═════╝  ╚═════╝  ╚═╝
</pre>
                </div>
            </div>
            <p class="tagline"><span>"</span>the system didn't crash. it just stopped caring.<span>"</span></p>
            <div class="status-bar">
                <span class="status-item">
                    <span class="status-dot"></span>
                    archive_online
                </span>
                <span class="status-item">
                    <span class="status-dot warn"></span>
                    integrity_degraded
                </span>
                <span class="status-item">
                    <span class="status-dot error"></span>
                    sync_abandoned
                </span>
            </div>
        </header>

        <nav class="nav-panel">
            <div class="nav-header">
                <span class="nav-label">.:[ARCHIVE_INDEX]:.</span>
                <span class="nav-path" id="nav-path">/sys/node7x/fragments/</span>
            </div>
            <div class="nav-grid">
                <button class="nav-btn active" data-section="home" data-file="pages/Cypherpunk_2001_PhrackStyle.txt">HOME</button>
                <button class="nav-btn" id="spec-trigger">SPEC</button>
                <button class="nav-btn" id="readme-trigger">README</button>
                <button class="nav-btn" id="concept-art-trigger">ART</button>
                <button class="nav-btn" id="map-trigger">WORLD</button>
                <button class="nav-btn" id="devlog-trigger">DEVLOG</button>
                <button class="nav-btn" id="story-trigger">BACKSTORY</button>
                <button class="nav-btn" id="bounty-trigger">BOUNTY</button>
            </div>
        </nav>

        <main class="content-panel">
            <div class="content-header">
                <span class="content-title" id="content-title">Accessing Fragment...</span>
                <span class="content-meta" id="content-meta">--</span>
            </div>
            <div class="content-body">
                <div id="content-inner"></div>
            </div>
        </main>

        <footer class="footer">
            <span class="footer-left">.:[CYPHERPUNK_2001]:.</span>
            <span class="footer-center">a future that already failed</span>
            <span class="footer-right"><span class="eof-marker">EOF</span> <span class="node-marker">// NODE_7X</span></span>
        </footer>
        <div class="footer-bottom">
            <span class="copyright">(c) <span id="current-year"></span> cypher2k1.net</span>
            <a href="#" class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">[ back to top ]</a>
        </div>
    </div>

    <div class="bottom-social">
        <a href="https://discord.gg/DSNShkBTdb" class="social-link" title="Discord"><img src="assets/discord.webp" alt="Discord" loading="lazy"></a>
        <a href="#" class="social-link" title="Twitch"><img src="assets/twitch.webp" alt="Twitch" loading="lazy"></a>
        <a href="#" class="social-link" title="YouTube"><img src="assets/youtube.webp" alt="YouTube" loading="lazy"></a>
        <a href="https://github.com/cypherpunk2001" class="social-link" title="GitHub"><img src="assets/github.webp" alt="GitHub" loading="lazy"></a>
        <a href="#" class="steam-wishlist" title="Wishlist on Steam"><img src="assets/steam_wishlist.webp" alt="Wishlist on Steam" loading="lazy"></a>
    </div>

    <script src="assets/script.js"></script>
    <script type="module">
        // Shijima Web - Easter egg mascot (desktop only)
        // Spawns when user highlights the entire ASCII logo
        const isDesktop = window.innerWidth >= 1024 && !('ontouchstart' in window);

        if (isDesktop) {
            let mascotSpawned = false;

            const spawnMascot = async () => {
                if (mascotSpawned) return;
                mascotSpawned = true;

                try {
                    const { ShijimaManager } = await import('./shijima-web-mascot/src/index.js');

                    const manager = new ShijimaManager({
                        allowBreeding: false,
                        maxMascots: 1
                    });

                    // Spawn mascot at random x position
                    const x = Math.random() * window.innerWidth;
                    await manager.spawn('./shijima-web-mascot/demo/mascot-cypherpunk/', { x, y: 0 });

                    // Cooldown for ceiling jump (once per 5 minutes)
                    let lastCeilingJump = 0;
                    const JUMP_COOLDOWN = 300000;

                    const mascot = manager.mascots[0];
                    if (mascot) {
                        const origSetBehavior = mascot.setBehavior.bind(mascot);
                        mascot.setBehavior = function(behaviorName, actionOverrides) {
                            const now = Date.now();
                            if (behaviorName === 'JumpToCeiling') {
                                if (now - lastCeilingJump < JUMP_COOLDOWN) {
                                    return origSetBehavior('WalkAlongWorkAreaFloor', actionOverrides);
                                }
                                lastCeilingJump = now;
                            }
                            return origSetBehavior(behaviorName, actionOverrides);
                        };
                    }

                    window.shijimaManager = manager;

                    // Party mode: show music player
                    const musicPlayer = document.getElementById('music-player');
                    if (musicPlayer) {
                        musicPlayer.style.display = '';
                    }

                    console.log('[SHIJIMA] Easter egg activated! Party mode!');
                } catch (e) {
                    console.error('[SHIJIMA] Failed to initialize:', e);
                    mascotSpawned = false;
                }
            };

            // Easter egg: detect when ASCII logo is fully selected
            const asciiLogo = document.querySelector('.ascii-logo');

            document.addEventListener('selectionchange', () => {
                if (mascotSpawned) return;

                const selection = window.getSelection();
                if (!selection || selection.isCollapsed) return;

                // Check if selection contains the ASCII logo
                const range = selection.getRangeAt(0);
                const logoText = asciiLogo?.textContent?.trim() || '';
                const selectedText = selection.toString().trim();

                // Check if most of the logo is selected (at least 80% of characters)
                const logoChars = logoText.replace(/\s/g, '');
                const selectedChars = selectedText.replace(/\s/g, '');

                if (selectedChars.length >= logoChars.length * 0.8 &&
                    asciiLogo?.contains(range.commonAncestorContainer)) {
                    spawnMascot();
                }
            });
        }
    </script>
</body>
</html>
